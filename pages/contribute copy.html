<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contribute • Justice McNeal LLC</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Cinzel:wght@600;700&display=swap">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="../assets/tailwind.css">
  <link rel="stylesheet" href="../assets/theme-dark-gold.css">

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter','ui-sans-serif','system-ui'], brand: ['Cinzel','serif'] },
          colors: { onyx:'#0b0b0c', onyx2:'#121214', gold:'#D4AF37', goldSoft:'#E0C463', line:'rgba(255,255,255,.15)' },
          boxShadow: { card:'0 24px 60px rgba(0,0,0,.45)' }
        }
      }
    }
  </script>

  <style>
    /* BACKGROUND */
    body {
      background:
        radial-gradient(1000px 600px at 10% -10%, rgba(212,175,55,.08), transparent 60%),
        radial-gradient(900px 500px at 120% 120%, rgba(255,255,255,.06), transparent 55%),
        linear-gradient(180deg, #111 0%, #0b0b0c 100%);
      color: #fff;
      min-height: 100vh;
      font-family: 'Inter', sans-serif;
    }
    body::after {
      content: "";
      position: absolute;
      inset: 0;
      background: url("/images/bg/assets/tree_001.png") right -60px bottom -40px / 520px auto no-repeat;
      opacity: .12;
      filter: grayscale(1) contrast(1.1);
      pointer-events: none;
      z-index: -1;
    }

    .card {
      background: rgba(18,18,20,.75);
      border: 1px solid rgba(255,255,255,.12);
      backdrop-filter: blur(8px);
      border-radius: 1rem;
      box-shadow: 0 24px 60px rgba(0,0,0,.45);
    }

    .text-gold { color: #D4AF37; }
    .gold-glow { text-shadow: 0 0 12px rgba(212,175,55,.25); }

    .btn-primary {
      background: linear-gradient(90deg,#D4AF37,#E0C463);
      color: #0b0b0c;
      font-weight: 600;
      border-radius: .5rem;
      padding: .6rem 1.2rem;
      transition: all .2s;
    }
    .btn-primary:hover { background: linear-gradient(90deg,#E0C463,#F0D97C); }

    .btn-light {
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.15);
      color: #fff;
      border-radius: .5rem;
      padding: .6rem 1.2rem;
      transition: all .2s;
    }
    .btn-light:hover { background: rgba(255,255,255,.15); }

    .btn-ghost {
      background: transparent;
      color: #D4AF37;
      border: 1px solid rgba(212,175,55,.4);
      border-radius: .5rem;
      padding: .6rem 1.2rem;
      transition: all .2s;
    }
    .btn-ghost:hover { background: rgba(212,175,55,.1); }

    .chip {
      border: 1px solid rgba(212,175,55,.4);
      color: #D4AF37;
      border-radius: .5rem;
      padding: .4rem .9rem;
      transition: all .2s;
    }
    .chip:hover { background: rgba(212,175,55,.15); }

    .stat-pills {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }
    .stat-pill {
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.1);
      border-radius: 1rem;
      padding: 1rem 1.25rem;
      backdrop-filter: blur(6px);
    }
    .stat-label {
      font-size: .8rem;
      color: rgba(255,255,255,.6);
    }
    .stat-value {
      font-size: 1.5rem;
      font-weight: 600;
      color: #D4AF37;
      margin-top: .3rem;
    }

    .badge-warning {
      background: rgba(212,175,55,.2);
      color: #D4AF37;
      padding: .25rem .6rem;
      border-radius: .4rem;
      font-size: .8rem;
      font-weight: 500;
    }

    input, select {
      background: rgba(255,255,255,.06);
      color: #fff;
      border: 1px solid rgba(255,255,255,.15);
    }
    input:focus, select:focus {
      outline: none;
      border-color: #D4AF37;
      box-shadow: 0 0 0 3px rgba(212,175,55,.25);
    }
  </style>
</head>

<body data-page="contribute" data-require-auth="member">
  <div class="mx-auto max-w-5xl px-4 py-6 md:px-6">

    <!-- Navbar mount -->
    <div id="navMount" class="mb-6"></div>

    <!-- Status Banner -->
    <div id="statusBanner" class="hidden mb-4 card p-3 text-sm text-gold"></div>

    <!-- HERO -->
    <section class="card p-6">
      <div class="flex flex-col md:flex-row items-center justify-between gap-6">
        <div class="flex-1">
          <div id="heroSkeleton" class="skel flex flex-col gap-3">
            <div class="skel-title"></div>
            <div class="skel-sub"></div>
            <div class="mt-2 flex gap-3">
              <div class="skel-btn w-56"></div>
              <div class="skel-btn w-44"></div>
            </div>
          </div>

          <div id="heroContent" class="hidden">
            <h1 id="pageTitle" class="font-brand text-3xl text-gold gold-glow">Contribute</h1>
            <p class="mt-2 text-white/70">
              Signed in as <span id="whoami" class="font-medium text-gold" aria-live="polite">Loading…</span>
            </p>
            <div id="rowMainActions" class="mt-4 flex flex-wrap gap-3">
              <button id="btnOpenConfirm" class="btn-primary">
                <span id="btnOpenConfirmText">Update Contribution</span>
              </button>
              <button id="btnBillingPortal" class="btn-light">Manage Billing</button>
            </div>

            <div id="rowCancelActions" class="mt-3 hidden flex gap-3 items-center">
              <span id="cancelNote" class="badge-warning"></span>
              <button id="btnResume" class="btn-ghost">Cancel cancellation</button>
            </div>
          </div>
        </div>

        <div class="hidden md:block shrink-0">
          <img src="/images/bg/assets/tree_001.png" alt="" class="w-44 opacity-60">
        </div>
      </div>
    </section>

    <!-- TOP STATS -->
    <div id="topSkeleton" class="mt-6 skel"></div>

    <div id="topContent" class="mt-6 hidden">
      <div class="stat-pills">
        <div class="stat-pill">
          <div class="stat-label">Current pledge</div>
          <div class="stat-value"><span id="currentPledge">$—</span><span class="text-sm opacity-70">/mo</span></div>
          <div id="cardSummaryRow" class="hidden mt-2 text-sm text-white/70">
            Default card: <span id="cardSummaryTxt" class="font-medium text-gold"></span>
          </div>
        </div>

        <div class="stat-pill">
          <div class="stat-label">Total contributed</div>
          <div id="totalContributed" class="stat-value">$—</div>
        </div>

        <div class="stat-pill">
          <div class="stat-label">Next billing</div>
          <div id="nextBillingDate" class="stat-value">—</div>
        </div>
      </div>
    </div>

    <!-- SET CONTRIBUTION -->
    <div class="card p-6 mt-6">
      <h2 class="text-lg font-semibold text-gold gold-glow">Set monthly contribution</h2>
      <p class="text-sm text-white/70">
        Use the presets or slider, then click <em>Update Contribution</em> above.
      </p>

      <div class="mt-4 grid grid-cols-[1fr_auto] items-center gap-4">
        <input id="pledgeSlider" type="range" min="50" max="2000" step="10" class="w-full accent-gold">
        <label for="pledgeInput" class="sr-only">Amount</label>
        <div class="flex items-center gap-2 rounded-lg bg-white/5 px-3 py-2 border border-white/10">
          <span class="text-gold">$</span>
          <input id="pledgeInput" type="number" min="50" max="2000" step="10"
                 class="w-24 bg-transparent text-right focus:outline-none" inputmode="numeric">
        </div>
      </div>

      <div id="presetRow" class="mt-4 flex flex-wrap gap-2">
        <button type="button" data-preset="50"  class="chip">$50</button>
        <button type="button" data-preset="100" class="chip">$100</button>
        <button type="button" data-preset="250" class="chip">$250</button>
        <button type="button" data-preset="500" class="chip">$500</button>
      </div>

      <div id="amtError" class="hidden mt-2 text-sm text-rose-400">
        Minimum is $50. Maximum is $2,000.
      </div>
      <div id="saveMsg" class="mt-2 text-sm text-white/60"></div>

      <ul class="mt-4 text-sm text-white/60 list-disc list-inside">
        <li>Changes take effect on your next billing date.</li>
        <li>A default payment method is required for billing.</li>
        <li>You can cancel anytime from the billing portal.</li>
      </ul>
    </div>

    <!-- PROJECTION -->
    <div class="card p-6 mt-6">
      <div class="flex flex-wrap items-center justify-between gap-4">
        <h2 class="text-lg font-semibold text-gold gold-glow">Projection</h2>
        <div class="flex items-center gap-3">
          <label for="projHorizon" class="text-sm text-white/70">Horizon</label>
          <select id="projHorizon" name="horizon" class="rounded-md border border-white/10 bg-white/5 px-3 py-2 text-sm text-white/90">
            <option value="3">3 months</option>
            <option value="6" selected>6 months</option>
            <option value="12">12 months</option>
          </select>
        </div>
      </div>
      <p class="mt-2 text-sm text-white/70">Estimate based on your current selection.</p>

      <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="rounded-xl bg-white/5 border border-white/10 p-4">
          <div class="text-xs uppercase tracking-wide text-white/60">Rate</div>
          <div id="projRate" class="mt-1 text-xl font-semibold text-gold">—</div>
        </div>

        <div class="rounded-xl bg-white/5 border border-white/10 p-4">
          <div class="text-xs uppercase tracking-wide text-white/60">Projected total</div>
          <div id="projTotal" class="mt-1 text-xl font-semibold text-gold">—</div>
        </div>
      </div>
    </div>

    <!-- ACTIVITY -->
    <div id="recentSkeleton" class="card p-6 mt-6"></div>
    <div id="activityContent" class="card p-0 mt-6 hidden">
      <div class="px-6 pt-6 flex items-center justify-between">
        <div>
          <h2 class="text-lg font-semibold text-gold gold-glow">Recent activity</h2>
          <div id="activityLegend" class="text-xs text-white/60 mt-1"></div>
        </div>
        <a href="/pages/history.html" class="text-sm text-gold hover:text-goldSoft transition">
          View full history →
        </a>
      </div>
      <div id="activityList" class="px-6 pt-2 pb-2"></div>
      <p data-activity-footnote="1" class="px-6 pb-4 text-[13px] text-white/50">
        Click a row to view a receipt when available.
      </p>
    </div>

    <!-- Confirm Modal -->
    <div id="confirmModal" class="hidden fixed inset-0 z-[100] flex items-center justify-center bg-black/60 p-4">
      <div class="card p-6 max-w-md w-full">
        <h3 id="confirmTitle" class="text-lg font-semibold text-gold">Confirm update</h3>
        <p id="confirmBody" class="mt-2 text-sm text-white/70">This takes effect on your next billing date.</p>
        <div class="mt-6 flex justify-end gap-3">
          <button id="btnCancelConfirm" class="btn-light">Cancel</button>
          <button id="btnConfirmUpdate" class="btn-primary">Confirm</button>
        </div>
      </div>
    </div>

  </div>

  <!-- Scripts -->
  <script type="module" src="/js/shared/bootstrap.js"></script>
  <script type="module" src="/js/pages/contribute/index.js"></script>
  <script type="module" src="/js/navbar/index.js"></script>
</body>
</html>
